"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ctor=_interopRequireDefault(require("xe-utils/ctor")),_tools=require("../../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var cellType="footer";function mergeFooterMethod(e,t,o){for(var l=0;l<e.length;l++){var r=e[l],n=r.row,a=r.col,i=r.rowspan,r=r.colspan;if(-1<a&&-1<n&&i&&r){if(n===t&&a===o)return{rowspan:i,colspan:r};if(n<=t&&t<n+i&&a<=o&&o<a+r)return{rowspan:0,colspan:0}}}}var _default={name:"VxeTableFooter",props:{footerData:Array,tableColumn:Array,visibleColumn:Array,fixedColumn:Array,size:String,fixedType:String},mounted:function(){var e=this.$parent,t=this.$el,o=this.$refs,l=this.fixedType,e=e.elemStore,l="".concat(l||"main","-footer-");e["".concat(l,"wrapper")]=t,e["".concat(l,"table")]=o.table,e["".concat(l,"colgroup")]=o.colgroup,e["".concat(l,"list")]=o.tfoot,e["".concat(l,"xSpace")]=o.xSpace},render:function(_){var e=this._e,h=this.$parent,w=this.fixedType,t=this.fixedColumn,T=this.tableColumn,$=this.footerData,C=h.$listeners,o=h.tId,l=h.footerRowClassName,I=h.footerCellClassName,r=h.footerRowStyle,S=h.footerCellStyle,F=h.footerAlign,L=h.mergeFooterList,P=h.footerSpanMethod,k=h.align,E=h.scrollXLoad,O=h.columnKey,q=h.showFooterOverflow,A=h.currentColumn,D=h.overflowX,n=h.scrollbarWidth,M=h.tooltipOpts;return L.length&&P||(w&&q||E&&w)&&(T=t),_("div",{class:["vxe-table--footer-wrapper",w?"fixed-".concat(w,"--wrapper"):"body--wrapper"],attrs:{"data-tid":o},on:{scroll:this.scrollEvent}},[w?e():_("div",{class:"vxe-body--x-space",ref:"xSpace"}),_("table",{class:"vxe-table--footer",attrs:{"data-tid":o,cellspacing:0,cellpadding:0,border:0},ref:"table"},[_("colgroup",{ref:"colgroup"},T.map(function(e,t){return _("col",{attrs:{name:e.id},key:t})}).concat(n?[_("col",{attrs:{name:"col_gutter"}})]:[])),_("tfoot",{ref:"tfoot"},$.map(function(y,g){var b=g;return _("tr",{class:["vxe-footer--row",l?_ctor.default.isFunction(l)?l({$table:h,_rowIndex:g,$rowIndex:b,fixed:w,type:cellType}):l:""],style:r?_ctor.default.isFunction(r)?r({$table:h,_rowIndex:g,$rowIndex:b,fixed:w,type:cellType}):r:null},T.map(function(t,e){var o=t.showFooterOverflow,l=t.footerAlign,r=t.align,n=t.footerClassName,a=M.enabled,i=t.children&&t.children.length,c=w?t.fixed!==w&&!i:t.fixed&&D,s=_ctor.default.isUndefined(o)||_ctor.default.isNull(o)?q:o,d=l||r||F||k,f="ellipsis"===s,u="title"===s,p=!0===s||"tooltip"===s,i=u||p||f,o={"data-colid":t.id},l={},r=h.getColumnIndex(t),s=h.getVTColumnIndex(t),x={$table:h,_rowIndex:g,$rowIndex:b,column:t,columnIndex:r,$columnIndex:e,_columnIndex:s,itemIndex:s,items:y,fixed:w,type:cellType,data:$};if(E&&!i&&(f=i=!0),(u||p||a)&&(l.mouseenter=function(e){u?_tools.DomTools.updateCellTitle(e.currentTarget,t):(p||a)&&h.triggerFooterTooltipEvent(e,x)}),(p||a)&&(l.mouseleave=function(e){(p||a)&&h.handleTargetLeaveEvent(e)}),C["footer-cell-click"]&&(l.click=function(e){h.emitEvent("footer-cell-click",Object.assign({cell:e.currentTarget},x),e)}),C["footer-cell-dblclick"]&&(l.dblclick=function(e){h.emitEvent("footer-cell-dblclick",Object.assign({cell:e.currentTarget},x),e)}),L.length){r=mergeFooterMethod(L,g,s);if(r){s=r.rowspan,r=r.colspan;if(!s||!r)return null;1<s&&(o.rowspan=s),1<r&&(o.colspan=r)}}else if(P){var m=P(x)||{},v=m.rowspan,v=void 0===v?1:v,m=m.colspan,m=void 0===m?1:m;if(!v||!m)return null;1<v&&(o.rowspan=v),1<m&&(o.colspan=m)}v="seq"===t.type||"index"===t.type?"seq":t.type;return _("td",{class:["vxe-footer--column",t.id,(_defineProperty(m={},"col--".concat(d),d),_defineProperty(m,"col--".concat(v),v),_defineProperty(m,"col--last",e===T.length-1),_defineProperty(m,"fixed--hidden",c),_defineProperty(m,"col--ellipsis",i),_defineProperty(m,"col--current",A===t),m),_tools.UtilTools.getClass(n,x),_tools.UtilTools.getClass(I,x)],attrs:o,style:S?_ctor.default.isFunction(S)?S(x):S:null,on:l,key:O?t.id:e},[_("div",{class:["vxe-cell",{"c--title":u,"c--tooltip":p,"c--ellipsis":f}]},t.renderFooter(_,x))])}).concat(n?[_("td",{class:"col--gutter"})]:[]))}))])])},methods:{scrollEvent:function(e){var t=this.$parent,o=this.fixedType,l=t.$refs,r=t.scrollXLoad,n=t.triggerScrollXEvent,a=t.lastScrollLeft,i=l.tableHeader,c=l.tableBody,s=l.tableFooter,l=l.validTip,i=i?i.$el:null,s=s?s.$el:null,c=c.$el,s=s.scrollLeft,a=s!==a;t.lastScrollLeft=s,t.lastScrollTime=Date.now(),i&&(i.scrollLeft=s),c&&(c.scrollLeft=s),r&&a&&n(e),a&&l&&l.visible&&l.updatePlacement(),t.emitEvent("scroll",{type:cellType,fixed:o,scrollTop:c.scrollTop,scrollLeft:s,isX:a,isY:!1},e)}}};exports.default=_default;