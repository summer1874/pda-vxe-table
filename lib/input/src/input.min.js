"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ctor=_interopRequireDefault(require("xe-utils/ctor")),_conf=_interopRequireDefault(require("../../conf")),_tools=require("../../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ownKeys(t,e){var a,n=Object.keys(t);return Object.getOwnPropertySymbols&&(a=Object.getOwnPropertySymbols(t),e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,a)),n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(a),!0).forEach(function(e){_defineProperty(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var browse=_tools.DomTools.browse,wheelName=browse.firefox?"DOMMouseScroll":"mousewheel",yearSize=20,monthSize=20;function toStringTime(e){if(e){var t,a,n,i=new Date;return _ctor.default.isDate(e)?(t=e.getHours(),a=e.getMinutes(),n=e.getSeconds()):(e=(e=_ctor.default.toString(e)).match(/^(\d{1,2})(:(\d{1,2}))?(:(\d{1,2}))?/))&&(t=e[1],a=e[3],n=e[5]),i.setHours(t||0),i.setMinutes(a||0),i.setSeconds(n||0),i}return new Date("")}function renderDefaultInput(e,t){var a=t.inpAttrs,n=t.inpEvents;return e("input",{ref:"input",class:"vxe-input--inner",domProps:{value:t.value},attrs:a,on:n})}function renderDateInput(e,t){var a=t.inpAttrs,n=t.inpEvents;return e("input",{ref:"input",class:"vxe-input--inner",domProps:{value:t.inputValue},attrs:a,on:n})}function renderDateLabel(t,e,a,n){var i=e.festivalMethod;if(i){i=i(_objectSpread({type:e.datePanelType},a)),e=i?_ctor.default.isString(i)?{label:i}:i:{},a=e.extra?_ctor.default.isString(e.extra)?{label:e.extra}:e.extra:null,i=[t("span",{class:["vxe-input--date-label",{"is-notice":e.notice}]},a&&a.label?[t("span",n),t("span",{class:["vxe-input--date-label--extra",a.important?"is-important":"",a.className],style:a.style},_ctor.default.toString(a.label))]:n)],a=e.label;return a&&(a=_ctor.default.toString(a).split(","),i.push(t("span",{class:["vxe-input--date-festival",e.important?"is-important":"",e.className],style:e.style},[1<a.length?t("span",{class:["vxe-input--date-festival--overlap","overlap--".concat(a.length)]},a.map(function(e){return t("span",e.substring(0,3))})):t("span",{class:"vxe-input--date-festival--label"},a[0].substring(0,3))]))),i}return n}function isDateDisabled(e,t){var a=e.disabledMethod||e.dateOpts.disabledMethod;return a&&a({type:e.type,date:t.date})}function renderDateDayTable(t,a){var e=a.datePanelType,n=a.dateValue,i=a.datePanelValue,s=a.dateHeaders,r=a.dayDatas,o="yyyy-MM-dd";return[t("table",{class:"vxe-input--date-".concat(e,"-view"),attrs:{cellspacing:0,cellpadding:0,border:0}},[t("thead",[t("tr",s.map(function(e){return t("th",e.label)}))]),t("tbody",r.map(function(e){return t("tr",e.map(function(e){return t("td",{class:{"is--prev":e.isPrev,"is--current":e.isCurrent,"is--now":e.isNow,"is--next":e.isNext,"is--disabled":isDateDisabled(a,e),"is--selected":_ctor.default.isDateSame(n,e.date,o),"is--hover":_ctor.default.isDateSame(i,e.date,o)},on:{click:function(){return a.dateSelectEvent(e)},mouseenter:function(){return a.dateMouseenterEvent(e)}}},renderDateLabel(t,a,e,e.label))}))}))])]}function renderDateWeekTable(n,i){var e=i.datePanelType,s=i.dateValue,r=i.datePanelValue,t=i.weekHeaders,a=i.weekDates,o="yyyy-MM-dd";return[n("table",{class:"vxe-input--date-".concat(e,"-view"),attrs:{cellspacing:0,cellpadding:0,border:0}},[n("thead",[n("tr",t.map(function(e){return n("th",e.label)}))]),n("tbody",a.map(function(e){var t=e.some(function(e){return _ctor.default.isDateSame(s,e.date,o)}),a=e.some(function(e){return _ctor.default.isDateSame(r,e.date,o)});return n("tr",e.map(function(e){return n("td",{class:{"is--prev":e.isPrev,"is--current":e.isCurrent,"is--now":e.isNow,"is--next":e.isNext,"is--disabled":isDateDisabled(i,e),"is--selected":t,"is--hover":a},on:{click:function(){return i.dateSelectEvent(e)},mouseenter:function(){return i.dateMouseenterEvent(e)}}},renderDateLabel(n,i,e,e.label))}))}))])]}function renderDateMonthTable(t,a){var n=a.dateValue,e=a.datePanelType,i=a.monthDatas,s=a.datePanelValue,r="yyyy-MM";return[t("table",{class:"vxe-input--date-".concat(e,"-view"),attrs:{cellspacing:0,cellpadding:0,border:0}},[t("tbody",i.map(function(e){return t("tr",e.map(function(e){return t("td",{class:{"is--prev":e.isPrev,"is--current":e.isCurrent,"is--now":e.isNow,"is--next":e.isNext,"is--disabled":isDateDisabled(a,e),"is--selected":_ctor.default.isDateSame(n,e.date,r),"is--hover":_ctor.default.isDateSame(s,e.date,r)},on:{click:function(){return a.dateSelectEvent(e)},mouseenter:function(){return a.dateMouseenterEvent(e)}}},renderDateLabel(t,a,e,_conf.default.i18n("vxe.input.date.months.m".concat(e.month))))}))}))])]}function renderDateYearTable(t,a){var n=a.dateValue,e=a.datePanelType,i=a.yearDatas,s=a.datePanelValue;return[t("table",{class:"vxe-input--date-".concat(e,"-view"),attrs:{cellspacing:0,cellpadding:0,border:0}},[t("tbody",i.map(function(e){return t("tr",e.map(function(e){return t("td",{class:{"is--disabled":isDateDisabled(a,e),"is--current":e.isCurrent,"is--now":e.isNow,"is--selected":_ctor.default.isDateSame(n,e.date,"yyyy"),"is--hover":_ctor.default.isDateSame(s,e.date,"yyyy")},on:{click:function(){return a.dateSelectEvent(e)},mouseenter:function(){return a.dateMouseenterEvent(e)}}},renderDateLabel(t,a,e,e.year))}))}))])]}function renderDateTable(e,t){switch(t.datePanelType){case"week":return renderDateWeekTable(e,t);case"month":return renderDateMonthTable(e,t);case"year":return renderDateYearTable(e,t)}return renderDateDayTable(e,t)}function renderDatePanel(e,t){var a=t.datePanelType,n=t.selectDatePanelLabel,i=t.isDisabledPrevDateBtn,s=t.isDisabledNextDateBtn;return[e("div",{class:"vxe-input--date-picker-header"},[e("div",{class:"vxe-input--date-picker-type-wrapper"},[e("span","year"===a?{class:"vxe-input--date-picker-label"}:{class:"vxe-input--date-picker-btn",on:{click:t.dateToggleTypeEvent}},n)]),e("div",{class:"vxe-input--date-picker-btn-wrapper"},[e("span",{class:["vxe-input--date-picker-btn vxe-input--date-picker-prev-btn",{"is--disabled":i}],on:{click:t.datePrevEvent}},[e("i",{class:"vxe-icon--caret-left"})]),e("span",{class:"vxe-input--date-picker-btn vxe-input--date-picker-current-btn",on:{click:t.dateTodayMonthEvent}},[e("i",{class:"vxe-icon--dot"})]),e("span",{class:["vxe-input--date-picker-btn vxe-input--date-picker-next-btn",{"is--disabled":s}],on:{click:t.dateNextEvent}},[e("i",{class:"vxe-icon--caret-right"})])])]),e("div",{class:"vxe-input--date-picker-body"},renderDateTable(e,t))]}function renderTimePanel(a,n){var e=n.dateTimeLabel,i=n.datetimePanelValue,t=n.hourList,s=n.minuteList,r=n.secondList;return[a("div",{class:"vxe-input--time-picker-header"},[a("span",{class:"vxe-input--time-picker-title"},e),a("button",{class:"vxe-input--time-picker-confirm",attrs:{type:"button"},on:{click:n.dateConfirmEvent}},_conf.default.i18n("vxe.button.confirm"))]),a("div",{ref:"timeBody",class:"vxe-input--time-picker-body"},[a("ul",{class:"vxe-input--time-picker-hour-list"},t.map(function(t,e){return a("li",{key:e,class:{"is--selected":i&&i.getHours()===t.value},on:{click:function(e){return n.dateHourEvent(e,t)}}},t.label)})),a("ul",{class:"vxe-input--time-picker-minute-list"},s.map(function(t,e){return a("li",{key:e,class:{"is--selected":i&&i.getMinutes()===t.value},on:{click:function(e){return n.dateMinuteEvent(e,t)}}},t.label)})),a("ul",{class:"vxe-input--time-picker-second-list"},r.map(function(t,e){return a("li",{key:e,class:{"is--selected":i&&i.getSeconds()===t.value},on:{click:function(e){return n.dateSecondEvent(e,t)}}},t.label)}))])]}function renderPanel(e,t){var a=t.type,n=t.vSize,i=t.isDatePicker,s=t.transfer,r=t.animatVisible,o=t.visiblePanel,l=t.panelPlacement,u=t.panelStyle,c=[];return i?("datetime"===a?c.push(e("div",{class:"vxe-input--panel-layout-wrapper"},[e("div",{class:"vxe-input--panel-left-wrapper"},renderDatePanel(e,t)),e("div",{class:"vxe-input--panel-right-wrapper"},renderTimePanel(e,t))])):"time"===a?c.push(e("div",{class:"vxe-input--panel-wrapper"},renderTimePanel(e,t))):c.push(e("div",{class:"vxe-input--panel-wrapper"},renderDatePanel(e,t))),e("div",{ref:"panel",class:["vxe-table--ignore-clear vxe-input--panel","type--".concat(a),(_defineProperty(a={},"size--".concat(n),n),_defineProperty(a,"is--transfer",s),_defineProperty(a,"animat--leave",r),_defineProperty(a,"animat--enter",o),a)],attrs:{"data-placement":l},style:u},c)):null}function renderNumberIcon(e,t){return e("span",{class:"vxe-input--number-suffix"},[e("span",{class:"vxe-input--number-prev is--prev",on:{mousedown:t.numberMousedownEvent,mouseup:t.numberStopDown,mouseleave:t.numberStopDown}},[e("i",{class:["vxe-input--number-prev-icon",_conf.default.icon.INPUT_PREV_NUM]})]),e("span",{class:"vxe-input--number-next is--next",on:{mousedown:t.numberMousedownEvent,mouseup:t.numberStopDown,mouseleave:t.numberStopDown}},[e("i",{class:["vxe-input--number-next-icon",_conf.default.icon.INPUT_NEXT_NUM]})])])}function renderDatePickerIcon(e,t){return e("span",{class:"vxe-input--date-picker-suffix",on:{click:t.datePickerOpenEvent}},[e("i",{class:["vxe-input--date-picker-icon",_conf.default.icon.INPUT_DATE]})])}function renderSearchIcon(e,t){return e("span",{class:"vxe-input--search-suffix",on:{click:t.searchEvent}},[e("i",{class:["vxe-input--search-icon",_conf.default.icon.INPUT_SEARCH]})])}function renderPasswordIcon(e,t){var a=t.showPwd;return e("span",{class:"vxe-input--password-suffix",on:{click:t.passwordToggleEvent}},[e("i",{class:["vxe-input--password-icon",a?_conf.default.icon.INPUT_SHOW_PWD:_conf.default.icon.INPUT_PWD]})])}function rendePrefixIcon(e,t){var a=t.$scopedSlots,n=t.prefixIcon,i=[];return a.prefix?i.push(e("span",{class:"vxe-input--prefix-icon"},a.prefix.call(this,{},e))):n&&i.push(e("i",{class:["vxe-input--prefix-icon",n]})),i.length?e("span",{class:"vxe-input--prefix",on:{click:t.clickPrefixEvent}},i):null}function renderSuffixIcon(e,t){var a=t.$scopedSlots,n=t.value,i=t.isClearable,s=t.disabled,r=t.suffixIcon,o=[];return a.suffix?o.push(e("span",{class:"vxe-input--suffix-icon"},a.suffix.call(this,{},e))):r&&o.push(e("i",{class:["vxe-input--suffix-icon",r]})),i&&o.push(e("i",{class:["vxe-input--clear-icon",_conf.default.icon.INPUT_CLEAR]})),o.length?e("span",{class:["vxe-input--suffix",{"is--clear":i&&!s&&!(""===n||_ctor.default.eqNull(n))}],on:{click:t.clickSuffixEvent}},o):null}function renderExtraSuffixIcon(e,t){var a,n=t.controls,i=t.isPassword,s=t.isNumber,r=t.isDatePicker,o=t.isSearch;return n&&(i?a=renderPasswordIcon(e,t):s?a=renderNumberIcon(e,t):r?a=renderDatePickerIcon(e,t):o&&(a=renderSearchIcon(e,t))),a?e("span",{class:"vxe-input--extra-suffix"},[a]):null}var _default2={name:"VxeInput",props:{value:[String,Number,Date],name:String,type:{type:String,default:"text"},clearable:{type:Boolean,default:function(){return _conf.default.input.clearable}},readonly:Boolean,disabled:Boolean,placeholder:String,maxlength:[String,Number],autocomplete:{type:String,default:"off"},align:String,form:String,size:{type:String,default:function(){return _conf.default.input.size||_conf.default.size}},min:{type:[String,Number],default:null},max:{type:[String,Number],default:null},step:[String,Number],controls:{type:Boolean,default:function(){return _conf.default.input.controls}},digits:{type:[String,Number],default:function(){return _conf.default.input.digits}},dateConfig:Object,minDate:{type:[String,Number,Date],default:function(){return _conf.default.input.minDate}},maxDate:{type:[String,Number,Date],default:function(){return _conf.default.input.maxDate}},startWeek:{type:Number,default:function(){return _conf.default.input.startWeek}},labelFormat:{type:String,default:function(){return _conf.default.input.labelFormat}},parseFormat:{type:String,default:function(){return _conf.default.input.parseFormat}},valueFormat:{type:String,default:function(){return _conf.default.input.valueFormat}},editable:{type:Boolean,default:!0},festivalMethod:{type:Function,default:function(){return _conf.default.input.festivalMethod}},disabledMethod:{type:Function,default:function(){return _conf.default.input.disabledMethod}},prefixIcon:String,suffixIcon:String,placement:String,transfer:{type:Boolean,default:function(){return _conf.default.input.transfer}}},data:function(){return{panelIndex:0,showPwd:!1,visiblePanel:!1,animatVisible:!1,panelStyle:null,panelPlacement:null,isActivated:!1,inputValue:"",datetimePanelValue:null,datePanelValue:null,datePanelLabel:"",datePanelType:"day",selectMonth:null,currentDate:null}},computed:{vSize:function(){return this.size||this.$parent.size||this.$parent.vSize},isNumber:function(){return-1<["number","integer","float"].indexOf(this.type)},isDatePicker:function(){return this.hasTime||-1<["date","week","month","year"].indexOf(this.type)},hasTime:function(){var e=this.type;return"time"===e||"datetime"===e},isPassword:function(){return"password"===this.type},isSearch:function(){return"search"===this.type},stepValue:function(){var e=this.type,t=this.step;return"integer"===e?_ctor.default.toInteger(t)||1:"float"===e?_ctor.default.toNumber(t)||1/Math.pow(10,this.digitsValue):_ctor.default.toNumber(t)||1},digitsValue:function(){return _ctor.default.toInteger(this.digits)||1},isClearable:function(){return this.clearable&&(this.isPassword||this.isNumber||this.isDatePicker||"text"===this.type||"search"===this.type)},isDisabledPrevDateBtn:function(){var e=this.selectMonth,t=this.dateMinTime;return!!e&&e<=t},isDisabledNextDateBtn:function(){var e=this.selectMonth,t=this.dateMaxTime;return!!e&&t<=e},dateMinTime:function(){return this.minDate?_ctor.default.toStringDate(this.minDate):null},dateMaxTime:function(){return this.maxDate?_ctor.default.toStringDate(this.maxDate):null},dateValue:function(){var e=this.value,t=this.isDatePicker,a=this.type,n=this.dateValueFormat;return e&&t?"time"===a?toStringTime(e,n):_ctor.default.toStringDate(e,n):null},dateTimeLabel:function(){var e=this.datetimePanelValue;return e?_ctor.default.toDateString(e,"HH:mm:ss"):""},hmsTime:function(){var e=this.dateValue;return e&&this.hasTime?1e3*(3600*e.getHours()+60*e.getMinutes()+e.getSeconds()):0},dateLabelFormat:function(){return this.isDatePicker?this.labelFormat||this.dateOpts.labelFormat||_conf.default.i18n("vxe.input.date.labelFormat.".concat(this.type)):null},dateValueFormat:function(){var e=this.type;return"time"===e?"HH:mm:ss":this.valueFormat||this.dateOpts.valueFormat||("datetime"===e?"yyyy-MM-dd HH:mm:ss":"yyyy-MM-dd")},selectDatePanelLabel:function(){if(this.isDatePicker){var e,t=this.datePanelType,a=this.selectMonth,n=this.yearList,i="";return a&&(i=a.getFullYear(),e=a.getMonth()+1),"month"===t?_conf.default.i18n("vxe.input.date.monthLabel",[i]):"year"===t?n.length?"".concat(n[0].year," - ").concat(n[n.length-1].year):"":_conf.default.i18n("vxe.input.date.dayLabel",[i,e?_conf.default.i18n("vxe.input.date.m".concat(e)):"-"])}return""},weekDatas:function(){var e=[];if(this.isDatePicker){var t=_ctor.default.toNumber((_ctor.default.isNumber(this.startWeek)?this:this.dateOpts).startWeek);e.push(t);for(var a=0;a<6;a++)6<=t?t=0:t++,e.push(t)}return e},dateHeaders:function(){return this.isDatePicker?this.weekDatas.map(function(e){return{value:e,label:_conf.default.i18n("vxe.input.date.weeks.w".concat(e))}}):[]},weekHeaders:function(){return this.isDatePicker?[{label:_conf.default.i18n("vxe.input.date.weeks.w")}].concat(this.dateHeaders):[]},yearList:function(){var e=this.selectMonth,t=this.currentDate,a=[];if(e&&t)for(var n=t.getFullYear(),i=new Date((""+e.getFullYear()).replace(/\d{1}$/,"0"),0,1),s=-10;s<yearSize-10;s++){var r=_ctor.default.getWhatYear(i,s,"first"),o=r.getFullYear();a.push({date:r,isCurrent:!0,isNow:n===o,year:o})}return a},yearDatas:function(){return _ctor.default.chunk(this.yearList,4)},monthList:function(){var e=this.selectMonth,t=this.currentDate,a=[];if(e&&t)for(var n=t.getFullYear(),i=t.getMonth(),s=_ctor.default.getWhatYear(e,0,"first").getFullYear(),r=-4;r<monthSize-4;r++){var o=_ctor.default.getWhatYear(e,0,r),l=o.getFullYear(),u=o.getMonth(),c=l<s;a.push({date:o,isPrev:c,isCurrent:l===s,isNow:l===n&&u===i,isNext:!c&&s<l,month:u})}return a},monthDatas:function(){return _ctor.default.chunk(this.monthList,4)},dayList:function(){var e=this.weekDatas,t=this.selectMonth,a=this.currentDate,n=this.hmsTime,i=[];if(t&&a)for(var s=a.getFullYear(),r=a.getMonth(),o=a.getDate(),l=t.getFullYear(),u=t.getMonth(),a=t.getDay(),a=-e.indexOf(a),c=new Date(_ctor.default.getWhatDay(t,a).getTime()+n),d=0;d<42;d++){var h=_ctor.default.getWhatDay(c,d),f=h.getFullYear(),p=h.getMonth(),v=h.getDate(),m=h<t;i.push({date:h,isPrev:m,isCurrent:f===l&&p===u,isNow:f===s&&p===r&&v===o,isNext:!m&&u!==p,label:v})}return i},dayDatas:function(){return _ctor.default.chunk(this.dayList,7)},weekDates:function(){return this.dayDatas.map(function(e){var t=e[0];return[{date:t.date,isWeekNumber:!0,isPrev:!1,isCurrent:!1,isNow:!1,isNext:!1,label:_ctor.default.getYearWeek(t.date)}].concat(e)})},dateOpts:function(){return Object.assign({},this.dateConfig,_conf.default.input.dateConfig)},hourList:function(){var e=[];if(this.hasTime)for(var t=0;t<24;t++)e.push({value:t,label:(""+t).padStart(2,0)});return e},minuteList:function(){var e=[];if(this.hasTime)for(var t=0;t<60;t++)e.push({value:t,label:(""+t).padStart(2,0)});return e},secondList:function(){return this.minuteList},inpAttrs:function(){var e=this.isDatePicker,t=this.isNumber,a=this.isPassword,n=this.type,i=this.name,s=this.placeholder,r=this.readonly,o=this.disabled,l=this.maxlength,u=this.form,c=this.autocomplete,d=this.showPwd,h=this.editable,f=n;(e||t||a&&d||"number"===n)&&(f="text");c={name:i,form:u,type:f,placeholder:s,maxlength:t&&!_ctor.default.toNumber(l)?16:l,readonly:r||"week"===n||!h||!1===this.dateOpts.editable,disabled:o,autocomplete:c};return s&&(c.placeholder=_tools.UtilTools.getFuncText(s)),c},inpEvents:function(){var a=this,n={};return _ctor.default.each(this.$listeners,function(e,t){-1===["change","clear","prefix-click","suffix-click"].indexOf(t)&&(n[t]=a.triggerEvent)}),this.isNumber?(n.keydown=this.keydownEvent,n[wheelName]=this.mousewheelEvent):this.isDatePicker&&(n.click=this.clickEvent),n.input=this.inputEvent,n.focus=this.focusEvent,n.blur=this.blurEvent,n}},watch:{value:function(){this.changeValue()},dateLabelFormat:function(){this.dateParseValue(this.datePanelValue),this.inputValue=this.datePanelLabel}},created:function(){this.initValue(),_tools.GlobalEvent.on(this,"mousewheel",this.handleGlobalMousewheelEvent),_tools.GlobalEvent.on(this,"mousedown",this.handleGlobalMousedownEvent),_tools.GlobalEvent.on(this,"keydown",this.handleGlobalKeydownEvent),_tools.GlobalEvent.on(this,"blur",this.handleGlobalBlurEvent)},mounted:function(){this.dateConfig&&_tools.UtilTools.warn("vxe.error.removeProp",["date-config"]),this.isDatePicker&&this.transfer&&document.body.appendChild(this.$refs.panel)},beforeDestroy:function(){var e=this.$refs.panel;e&&e.parentNode&&e.parentNode.removeChild(e)},destroyed:function(){this.numberStopDown(),_tools.GlobalEvent.off(this,"mousewheel"),_tools.GlobalEvent.off(this,"mousedown"),_tools.GlobalEvent.off(this,"keydown"),_tools.GlobalEvent.off(this,"blur")},render:function(e){var t=this.controls,a=this.isDatePicker,n=this.visiblePanel,i=this.isActivated,s=this.vSize,r=this.type,o=this.align,l=this.readonly,u=this.disabled,c=[],d=rendePrefixIcon(e,this),h=renderSuffixIcon(e,this);return d&&c.push(d),c.push((a?renderDateInput:renderDefaultInput)(e,this)),h&&c.push(h),c.push(renderExtraSuffixIcon(e,this)),a&&c.push(renderPanel(e,this)),e("div",{class:["vxe-input","type--".concat(r),(_defineProperty(r={},"size--".concat(s),s),_defineProperty(r,"is--".concat(o),o),_defineProperty(r,"is--controls",t),_defineProperty(r,"is--prefix",!!d),_defineProperty(r,"is--suffix",!!h),_defineProperty(r,"is--readonly",l),_defineProperty(r,"is--visivle",n),_defineProperty(r,"is--disabled",u),_defineProperty(r,"is--active",i),r)]},c)},methods:{focus:function(){return this.$refs.input.focus(),this.$nextTick()},blur:function(){return this.$refs.input.blur(),this.$nextTick()},triggerEvent:function(e){var t=this.$refs,a=this.value;this.$emit(e.type,{$panel:t.panel,value:a,$event:e},e)},emitUpdate:function(e,t){_ctor.default.toString(this.value)!==e&&(this.$emit("input",e),this.$emit("change",{value:e,$event:t}))},inputEvent:function(e){var t=this.isDatePicker,a=e.target.value;this.inputValue=a,t||this.emitUpdate(a,e)},focusEvent:function(e){this.isActivated=!0,this.triggerEvent(e)},blurEvent:function(e){this.afterCheckValue(),this.triggerEvent(e)},keydownEvent:function(e){var t,a,n,i;this.isNumber&&(t=e.ctrlKey,a=e.shiftKey,n=e.altKey,i=e.keyCode,t||a||n||!(32===i||65<=i&&i<=90)||e.preventDefault(),this.numberKeydownEvent(e)),this.triggerEvent(e)},mousewheelEvent:function(e){var t;this.isNumber&&this.controls&&this.isActivated&&(0<(t=-e.wheelDelta||e.detail)?this.numberNextEvent(e):t<0&&this.numberPrevEvent(e),e.preventDefault())},clickEvent:function(e){this.isDatePicker&&this.datePickerOpenEvent(e),this.triggerEvent(e)},clickPrefixEvent:function(e){var t=this.$refs,a=this.disabled,n=this.value;a||this.$emit("prefix-click",{$panel:t.panel,value:n,$event:e},e)},clickSuffixEvent:function(e){var t=this.$refs,a=this.disabled,n=this.value;a||(_tools.DomTools.hasClass(e.currentTarget,"is--clear")?(this.emitUpdate("",e),this.clearValueEvent(e,"")):this.$emit("suffix-click",{$panel:t.panel,value:n,$event:e},e))},clearValueEvent:function(e,t){var a=this.$refs,n=this.type,i=this.isNumber;this.isDatePicker&&this.hidePanel(),(i||-1<["text","password"].indexOf(n))&&this.focus(),this.$emit("clear",{$panel:a.panel,value:t,$event:e},e)},initValue:function(){var e=this.type,t=this.isDatePicker,a=this.value,n=this.digitsValue;t?this.changeValue():"float"===e&&(!a||a!==(n=_ctor.default.toFixed(_ctor.default.floor(a,n),n))&&this.emitUpdate(n,{type:"init"}))},changeValue:function(){this.isDatePicker&&(this.dateParseValue(this.value),this.inputValue=this.datePanelLabel)},afterCheckValue:function(){var e=this.type,t=this.inpAttrs,a=this.value,n=this.inputValue,i=this.isDatePicker,s=this.isNumber,r=this.datetimePanelValue,o=this.dateLabelFormat,l=this.min,u=this.max,c=this.digitsValue;t.readonly||(s?a&&(s="integer"===e?_ctor.default.toInteger(a):_ctor.default.toNumber(a),this.vaildMinNum(s)?this.vaildMaxNum(s)||(s=u):s=l,this.emitUpdate("float"===e?_ctor.default.toFixed(_ctor.default.floor(s,c),c):_ctor.default.toString(s),{type:"check"})):i&&((n=n)?(n="time"===e?toStringTime(n,o):_ctor.default.toStringDate(n,o),_ctor.default.isValidDate(n)?"time"===e?(a!==(n=_ctor.default.toDateString(n,o))&&this.emitUpdate(n,{type:"check"}),this.inputValue=n):_ctor.default.isDateSame(a,n,o)?this.inputValue=_ctor.default.toDateString(a,o):("datetime"===e&&(r.setHours(n.getHours()),r.setMinutes(n.getMinutes()),r.setSeconds(n.getSeconds())),this.dateChange(n)):this.dateRevert()):this.emitUpdate("",{type:"check"})))},passwordToggleEvent:function(e){var t=this.disabled,a=this.readonly,n=this.showPwd;t||a||(this.showPwd=!n),this.$emit("toggle-visible",{visible:this.showPwd,$event:e})},searchEvent:function(e){this.$emit("search-click",{$event:e})},vaildMinNum:function(e){return null===this.min||e>=_ctor.default.toNumber(this.min)},vaildMaxNum:function(e){return null===this.max||e<=_ctor.default.toNumber(this.max)},numberStopDown:function(){clearTimeout(this.downbumTimeout)},numberDownPrevEvent:function(e){var t=this;this.downbumTimeout=setTimeout(function(){t.numberPrevEvent(e),t.numberDownPrevEvent(e)},60)},numberDownNextEvent:function(e){var t=this;this.downbumTimeout=setTimeout(function(){t.numberNextEvent(e),t.numberDownNextEvent(e)},60)},numberKeydownEvent:function(e){var t=e.keyCode,a=38===t;!a&&40!==t||(e.preventDefault(),a?this.numberPrevEvent(e):this.numberNextEvent(e))},numberMousedownEvent:function(e){var t,a=this;this.numberStopDown(),0===e.button&&((t=_tools.DomTools.hasClass(e.currentTarget,"is--prev"))?this.numberPrevEvent(e):this.numberNextEvent(e),this.downbumTimeout=setTimeout(function(){t?a.numberDownPrevEvent(e):a.numberDownNextEvent(e)},500))},numberPrevEvent:function(e){var t=this.disabled,a=this.readonly;clearTimeout(this.downbumTimeout),t||a||this.numberChange(!0,e),this.$emit("prev-number",{$event:e})},numberNextEvent:function(e){var t=this.disabled,a=this.readonly;clearTimeout(this.downbumTimeout),t||a||this.numberChange(!1,e),this.$emit("next-number",{$event:e})},numberChange:function(e,t){var a=this.type,n=this.digitsValue,i=this.value,s=this.stepValue,i="integer"===a?_ctor.default.toInteger(i):_ctor.default.toNumber(i),s=e?_ctor.default.add(i,s):_ctor.default.subtract(i,s);this.vaildMinNum(s)&&this.vaildMaxNum(s)&&this.emitUpdate("float"===a?_ctor.default.toFixed(_ctor.default.floor(s,n),n):_ctor.default.toString(s),t)},datePickerOpenEvent:function(e){e.preventDefault(),this.showPanel()},dateMonthHandle:function(e,t){this.selectMonth=_ctor.default.getWhatMonth(e,t,"first")},dateNowHandle:function(){var e=_ctor.default.getWhatDay(Date.now(),0,"first");this.currentDate=e,this.dateMonthHandle(e,0)},dateToggleTypeEvent:function(){var e="month"===(e=this.datePanelType)?"year":"month";this.datePanelType=e},datePrevEvent:function(e){var t=this.isDisabledPrevDateBtn,a=this.type,n=this.datePanelType;t||(this.selectMonth="year"===a?_ctor.default.getWhatYear(this.selectMonth,-yearSize,"first"):"month"===a?"year"===n?_ctor.default.getWhatYear(this.selectMonth,-yearSize,"first"):_ctor.default.getWhatYear(this.selectMonth,-1,"first"):"year"===n?_ctor.default.getWhatYear(this.selectMonth,-yearSize,"first"):"month"===n?_ctor.default.getWhatYear(this.selectMonth,-1,"first"):_ctor.default.getWhatMonth(this.selectMonth,-1,"first"),this.$emit("date-prev",{type:a,$event:e}))},dateTodayMonthEvent:function(e){this.dateNowHandle(),this.dateChange(this.currentDate),this.hidePanel(),this.$emit("date-today",{type:this.type,$event:e})},dateNextEvent:function(e){var t=this.isDisabledNextDateBtn,a=this.type,n=this.datePanelType;t||(this.selectMonth="year"===a?_ctor.default.getWhatYear(this.selectMonth,yearSize,"first"):"month"===a?"year"===n?_ctor.default.getWhatYear(this.selectMonth,yearSize,"first"):_ctor.default.getWhatYear(this.selectMonth,1,"first"):"year"===n?_ctor.default.getWhatYear(this.selectMonth,yearSize,"first"):"month"===n?_ctor.default.getWhatYear(this.selectMonth,1,"first"):_ctor.default.getWhatMonth(this.selectMonth,1,"first"),this.$emit("date-prev",{type:a,$event:e}))},dateSelectEvent:function(e){isDateDisabled(this,e)||this.dateSelectItem(e.date)},dateSelectItem:function(e){var t=this.type,a=this.datePanelType;"month"===t?"year"===a?(this.datePanelType="month",this.dateCheckMonth(e)):(this.dateChange(e),this.hidePanel()):"year"===t?(this.hidePanel(),this.dateChange(e)):"month"===a?(this.datePanelType="week"===t?t:"day",this.dateCheckMonth(e)):"year"===a?(this.datePanelType="month",this.dateCheckMonth(e)):(this.dateChange(e),this.hidePanel())},dateMouseenterEvent:function(e){var t;isDateDisabled(this,e)||("month"===(t=this.datePanelType)?this.dateMoveMonth(e.date):"year"===t?this.dateMoveYear(e.date):this.dateMoveDay(e.date))},dateHourEvent:function(e,t){this.datetimePanelValue.setHours(t.value),this.dateTimeChangeEvent(e)},dateConfirmEvent:function(){this.dateChange(this.dateValue||this.currentDate),this.hidePanel()},dateMinuteEvent:function(e,t){this.datetimePanelValue.setMinutes(t.value),this.dateTimeChangeEvent(e)},dateSecondEvent:function(e,t){this.datetimePanelValue.setSeconds(t.value),this.dateTimeChangeEvent(e)},dateTimeChangeEvent:function(e){this.datetimePanelValue=new Date(this.datetimePanelValue.getTime()),this.updateTimePos(e.currentTarget)},updateTimePos:function(e){var t;e&&(t=e.offsetHeight,e.parentNode.scrollTop=e.offsetTop-4*t)},dateMoveDay:function(t){isDateDisabled(this,{date:t})||(this.dayList.some(function(e){return _ctor.default.isDateSame(e.date,t,"yyyy-MM-dd")})||this.dateCheckMonth(t),this.dateParseValue(t))},dateMoveMonth:function(t){isDateDisabled(this,{date:t})||(this.monthList.some(function(e){return _ctor.default.isDateSame(e.date,t,"yyyy-MM")})||this.dateCheckMonth(t),this.dateParseValue(t))},dateMoveYear:function(t){isDateDisabled(this,{date:t})||(this.yearList.some(function(e){return _ctor.default.isDateSame(e.date,t,"yyyy")})||this.dateCheckMonth(t),this.dateParseValue(t))},dateParseValue:function(e){var t=this.type,a=this.dateLabelFormat,n=this.parseFormat,i=null,s="";e&&(i="time"===t?toStringTime(e,n||this.dateOpts.parseFormat):_ctor.default.toStringDate(e,n||this.dateOpts.parseFormat)),_ctor.default.isValidDate(i)?s=_ctor.default.toDateString(i,a):i=null,this.datePanelValue=i,this.datePanelLabel=s},dateOffsetEvent:function(e){var t,a,n,i=this.isActivated,s=this.datePanelValue,r=this.datePanelType;i&&(e.preventDefault(),t=37===(n=e.keyCode),a=38===n,i=39===n,e=40===n,"year"===r?(n=_ctor.default.getWhatYear(s||Date.now(),0,"first"),t?n=_ctor.default.getWhatYear(n,-1):a?n=_ctor.default.getWhatYear(n,-4):i?n=_ctor.default.getWhatYear(n,1):e&&(n=_ctor.default.getWhatYear(n,4)),this.dateMoveYear(n)):"month"===r?(r=_ctor.default.getWhatMonth(s||Date.now(),0,"first"),t?r=_ctor.default.getWhatMonth(r,-1):a?r=_ctor.default.getWhatMonth(r,-4):i?r=_ctor.default.getWhatMonth(r,1):e&&(r=_ctor.default.getWhatMonth(r,4)),this.dateMoveMonth(r)):(s=s||_ctor.default.getWhatDay(Date.now(),0,"first"),t?s=_ctor.default.getWhatDay(s,-1):a?s=_ctor.default.getWhatWeek(s,-1):i?s=_ctor.default.getWhatDay(s,1):e&&(s=_ctor.default.getWhatWeek(s,1)),this.dateMoveDay(s)))},datePgOffsetEvent:function(e){var t;this.isActivated&&(t=33===e.keyCode,e.preventDefault(),t?this.datePrevEvent(e):this.dateNextEvent(e))},dateChange:function(e){var t,a=this.value,n=this.datetimePanelValue,i=this.dateValueFormat;"week"===this.type?(t=_ctor.default.toNumber((_ctor.default.isNumber(this.startWeek)?this:this.dateOpts).startWeek),e=_ctor.default.getWhatWeek(e,0,t)):this.hasTime&&(e.setHours(n.getHours()),e.setMinutes(n.getMinutes()),e.setSeconds(n.getSeconds()));i=_ctor.default.toDateString(e,i);this.dateCheckMonth(e),_ctor.default.isEqual(a,i)||this.emitUpdate(i,{type:"update"})},dateCheckMonth:function(e){e=_ctor.default.getWhatMonth(e,0,"first");_ctor.default.isEqual(e,this.selectMonth)||(this.selectMonth=e)},dateOpenPanel:function(){var e=this,t=this.type,a=this.dateValue;-1<["year","month","week"].indexOf(t)?this.datePanelType=t:this.datePanelType="day",this.currentDate=_ctor.default.getWhatDay(Date.now(),0,"first"),a?(this.dateMonthHandle(a,0),this.dateParseValue(a)):this.dateNowHandle(),this.hasTime&&(this.datetimePanelValue=this.datePanelValue||_ctor.default.getWhatDay(Date.now(),0,"first"),this.$nextTick(function(){_ctor.default.arrayEach(e.$refs.timeBody.querySelectorAll("li.is--selected"),e.updateTimePos)}))},dateRevert:function(){this.inputValue=this.datePanelLabel},updateZindex:function(){this.panelIndex<_tools.UtilTools.getLastZIndex()&&(this.panelIndex=_tools.UtilTools.nextZIndex())},showPanel:function(){var e=this,t=this.disabled,a=this.visiblePanel,n=this.isDatePicker;t||a||(clearTimeout(this.hidePanelTimeout),this.isActivated=!0,this.animatVisible=!0,n&&this.dateOpenPanel(),setTimeout(function(){e.visiblePanel=!0},10),this.updateZindex(),this.updatePlacement())},hidePanel:function(){var e=this;this.visiblePanel=!1,this.hidePanelTimeout=setTimeout(function(){e.animatVisible=!1},350)},updatePlacement:function(){var h=this;return this.$nextTick().then(function(){var e=h.$refs,t=h.transfer,a=h.placement,n=h.panelIndex,i=e.input,s=e.panel;if(i&&s){var r=i.offsetHeight,o=i.offsetWidth,l=s.offsetHeight,u=s.offsetWidth,c={zIndex:n},d=_tools.DomTools.getAbsolutePos(i),e=d.boundingTop,s=d.boundingLeft,n=d.visibleHeight,i=d.visibleWidth,d="bottom";return t?(t=e+r,"top"===a?(d="top",t=e-l):a||(n<t+l+5&&(d="top",t=e-l),t<5&&(d="bottom",t=e+r)),i<(s=s)+u+5&&(s-=s+u+5-i),s<5&&(s=5),Object.assign(c,{left:"".concat(s,"px"),top:"".concat(t,"px"),minWidth:"".concat(o,"px")})):"top"===a?(d="top",c.bottom="".concat(r,"px")):a||n<e+r+l&&5<e-r-l&&(d="top",c.bottom="".concat(r,"px")),h.panelStyle=c,h.panelPlacement=d,h.$nextTick()}})},handleGlobalMousedownEvent:function(e){var t=this.$refs,a=this.$el,n=this.disabled,i=this.visiblePanel,s=this.isActivated;!n&&s&&(this.isActivated=_tools.DomTools.getEventTargetNode(e,a).flag||_tools.DomTools.getEventTargetNode(e,t.panel).flag,this.isActivated||(this.isDatePicker?i&&(this.hidePanel(),this.afterCheckValue()):this.afterCheckValue()))},handleGlobalKeydownEvent:function(e){var t,a,n,i,s,r,o,l,u,c,d=this.isDatePicker,h=this.visiblePanel,f=this.clearable;this.disabled||(t=9===(c=e.keyCode),a=46===c,n=27===c,i=13===c,s=38===c,r=40===c,o=33===c,l=34===c,u=37===c||s||39===c||r,c=this.isActivated,t?(c&&this.afterCheckValue(),c=!1,this.isActivated=c):u?d&&c&&(h?this.dateOffsetEvent(e):(s||r)&&(e.preventDefault(),this.showPanel())):i?d&&(h?this.datePanelValue?this.dateSelectItem(this.datePanelValue):this.hidePanel():c&&this.showPanel()):(o||l)&&d&&c&&this.datePgOffsetEvent(e),t||n?h&&this.hidePanel():a&&f&&c&&this.clearValueEvent(e,null))},handleGlobalMousewheelEvent:function(e){var t=this.$refs,a=this.disabled,n=this.visiblePanel;a||n&&(_tools.DomTools.getEventTargetNode(e,t.panel).flag?this.updatePlacement():(this.hidePanel(),this.afterCheckValue()))},handleGlobalBlurEvent:function(){var e=this.isActivated;this.visiblePanel?(this.hidePanel(),this.afterCheckValue()):e&&this.afterCheckValue()}}};exports.default=_default2;